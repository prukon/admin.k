# Регистрация точки для партнёра (Раздел 1.3)

Источник: документация Т-Банка «Регистрация и обновление партнёров», версия 1.8 от 27.10.2025 :contentReference[oaicite:0]{index=0}

---

## 1. Назначение раздела

Раздел описывает API для **регистрации торговой точки партнёра** (магазина Мультирасчётов) в системе Т-Банка.

Регистрация выполняется **одним POST-запросом** с передачей полного набора данных о юридическом лице, руководителе, учредителях и банковских реквизитах.

---

## 2. Общие параметры запроса

- **Метод:** POST  
- **Формат тела:** JSON  
- **Content-Type:** `application/json`  
- **URL:**
  - Тестовый: `https://acqapi-test.tinkoff.ru/sm-register/register`
  - Боевой: `https://acqapi.tinkoff.ru/sm-register/register`
- **Авторизация:**  
  `Authorization: Bearer <access_token>`
- **Дополнительно:**
  - IP-адреса клиента должны быть добавлены в whitelist (через `acq_help@tbank.ru`)
  - Для боевого URL требуется **mTLS-сертификат**

---

## 3. Обязательные параметры запроса

### 3.1. Общие данные точки

- `billingDescriptor` — название магазина (SMS / 3DS, латиница)
- `fullName` — полное наименование организации
- `name` — сокращённое наименование (кириллица + ОПФ)
- `inn` — ИНН
- `kpp` — КПП (если отсутствует — `000000000`)
- `ogrn` — ОГРН
- `addresses` — массив адресов
  - `addresses[].type`
  - `addresses[].zip`
  - `addresses[].country` (ISO Alpha-3)
  - `addresses[].city`
  - `addresses[].street`
- `email` — email партнёра
- `siteUrl` — адрес сайта

---

### 3.2. Учредители (founders)

- `founders.individuals` — массив **обязателен**
- Для каждого учредителя обязательно:
  - `firstName`
  - `lastName`
  - `citizenship`
  - `address`

---

### 3.3. Руководитель (ceo)

Объект `ceo` **обязателен**:

- `firstName`
- `lastName`
- `phone`
- `country` (ISO 3166-1 Alpha-3)

---

### 3.4. Банковские реквизиты

Объект `bankAccount` **обязателен**:

- `account` — расчётный / казначейский счёт
- `bankName`
- `bik`
- `details` — назначение платежа

> Если указан **один** из параметров `kbk` или `oktmo`, **второй обязателен**.

---

## 4. Необязательные параметры (факт наличия)

- `serviceProviderEmail`
- `mcc`
- `shopArticleId`
- `okved`
- `regDepartment`
- `regDate`
- `phones`
- `assets`
- `licenses`
- `primaryActivities`
- `comment`
- `nonResident` (всегда `false`)

---

## 5. Ответ API

### 5.1. Успешный ответ

- `code` — код точки со стороны партнёра (shopArticleId)
- `shopCode` — идентификатор точки в Т-Банке (**ключевой идентификатор**)
- `terminals` — массив терминалов (для Мультирасчётов пустой)

---

### 5.2. Ошибка

- HTTP status ≠ 200
- Возможные форматы:
  - Общая ошибка (`message`)
  - Ошибки валидации (`errors[]`)

Каждая ошибка содержит:
- `field`
- `defaultMessage`
- `rejectedValue`
- `code`

---

## 6. Критичные валидации и ограничения

### 6.1. Формат и значения

- Все параметры **чувствительны к регистру**
- В `addresses` допускаются **только** символы `.` и `,`
- `name` — строго кириллица + ОПФ
- `billingDescriptor`:
  - длина 1–14
  - допустимый шаблон: `[A-z0-9.\-_ ]+`

---

### 6.2. Логика обработки

- Если `mcc` не соответствует торговой группе — `merchantIds` игнорируется
- Если `shopArticleId` не передан — значение генерирует банк
- Некорректные банковские реквизиты → отказ регистрации
- Повторная регистрация активной точки → ошибка

---

## 7. Безопасность и доступ

- Обязательная OAuth-авторизация
- Обязательный Bearer Token
- Обязательный IP whitelist
- Обязательный mTLS для боевого контура

---

## 8. Ключевые ошибки (неполный перечень)

- Не задан `billingDescriptor`
- Не задан `inn`, `ogrn`, `name`
- Не заданы обязательные поля `addresses`
- Ошибки КБК / ОКТМО (формат или неполная пара)
- Неверные банковские реквизиты
- Точка уже активирована

---

## 9. Итог (факт)

Регистрация точки — **строго валидируемый** процесс с обязательной передачей полного профиля юрлица, руководителя и банковских реквизитов.  
Любое несоответствие формату, обязательности или бизнес-логике приводит к отказу регистрации.
